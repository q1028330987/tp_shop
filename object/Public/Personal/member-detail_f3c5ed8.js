$(function(){VIVO_UI.HighLightMyCenterNav("个人资料");var e,a={init:function(){new ChineseBirthdaySelector({$dayType:$("#dayType"),$year:$("#year"),$month:$("#month"),$day:$("#day"),dayType:dayType,birthday:birthday}),e=new Region({container:$("#j_ReginContriner")});var a=$("input.province").val(),n=$("input.city").val(),t=$("input.area").val();null!=a&&""!=a&&null!=n&&""!=n&&null!=t&&""!=t&&e.setValue([a,n,t])},initEvent:function(){var e=this;e.submitInformation()},dialog:function(e,a,n,t,i){new Dialog({title:e,content:a,icon:n,confirmBtn:!0,cancelBtn:t,confirmCallback:i})},submitInformation:function(){var e=this;$("body").on("click",".btn-submit",function(){if(!n.form())return void n.focusInvalid();if("-1"!=$("#dayType").val()){var a=parseInt($("#month").val())>12;a?($("input[name='birthdayType']").val("3"),$("input[name='birthday']").val([$("#year").val(),parseInt($("#month").val())-12,$("#day").val()].join("-"))):($("input[name='birthdayType']").val($("#dayType").val()),$("input[name='birthday']").val([$("#year").val(),$("#month").val(),$("#day").val()].join("-")))}else $("input[name='birthdayType']").val(null),$("input[name='birthday']").val(null);$.ajax({url:webCtx+"/my/saveInformation",type:"POST",data:$(".information-form").serialize(),success:function(a){200==a.retCode?e.dialog("成功",a.retMsg,"success"):e.dialog("失败",a.retMsg,"warning")},error:function(e){0==e.status?LoginConfirm.redirect():window.location.href=webCtx+"/error/forbidden"}})})}};$.validator.addMethod("address",function(e,a){return this.optional(a)||"_NULL_"!=e}),$.validator.addMethod("member_name",function(e,a){var n=e.length;return this.optional(a)||15>=n}),$.validator.addMethod("typeCheck",function(e,a){return this.optional(a)||"-1"!=e});var n=$(".information-form").validate({debug:!0,errorElement:"span",errorClass:"error-style",focusInvalid:!1,rules:{realName:{required:!0,member_name:!0},typeCheck:{typeCheck:!0},province:{address:!0},city:{address:!0},area:{address:!0}},messages:{realName:{required:"请填写您的姓名！",member_name:"姓名小于15个字符！"},typeCheck:{typeCheck:"请选择生日！"},province:{address:"请选择省份！"},city:{address:"请选择市区！"},area:{address:"请选择区域！"}}});a.init(),a.initEvent()});